# RDS ç›‘æ§æŒ‡æ ‡å’Œå‘Šè­¦é˜ˆå€¼æ±‡æ€»

**ç”Ÿæˆæ—¶é—´**: 2025-10-29  
**æ€»å‘Šè­¦æ•°**: 42 ä¸ª  
**è¦†ç›–å®ä¾‹**: 5 ä¸ª  

---

## ğŸ“Š æŒ‰ç›‘æ§æŒ‡æ ‡åˆ†ç±»

### 1ï¸âƒ£ CPU å’Œè®¡ç®—èµ„æº

#### CPUUtilization (å¾…é…ç½®)
- **è¯´æ˜**: CPU ä½¿ç”¨ç‡ç›‘æ§
- **é…ç½®**: ç›®å‰æœªå•ç‹¬é…ç½®å‘Šè­¦
- **å»ºè®®**: æ‰€æœ‰å®ä¾‹é…ç½® â‰¥90% å‘Šè­¦

#### CPUCreditBalance (t4g ä¸“å±)
| å®ä¾‹ | é˜ˆå€¼ | è¯´æ˜ |
|------|------|------|
| bingo-prd-backstage-replica1 | â‰¤ 100 credits | ç§¯åˆ†è¿‡ä½å½±å“æ€§èƒ½ |
| bingo-prd-loyalty | â‰¤ 100 credits | ç§¯åˆ†è¿‡ä½å½±å“æ€§èƒ½ |

---

### 2ï¸âƒ£ å†…å­˜èµ„æº

#### FreeableMemory (æ‰€æœ‰å®ä¾‹)
| å®ä¾‹ | å®ä¾‹ç±»å‹ | é˜ˆå€¼ | RAM å æ¯” |
|------|---------|------|----------|
| bingo-prd | m6g.large | â‰¤ 2 GB | 25% of 8GB |
| bingo-prd-replica1 | m6g.large | â‰¤ 2 GB | 25% of 8GB |
| bingo-prd-backstage | m6g.large | â‰¤ 2 GB | 25% of 8GB |
| bingo-prd-backstage-replica1 | t4g.medium | â‰¤ 1 GB | 25% of 4GB |
| bingo-prd-loyalty | t4g.medium | â‰¤ 1 GB | 25% of 4GB |

---

### 3ï¸âƒ£ å­˜å‚¨ I/O æ€§èƒ½

#### EBSByteBalance% (å¾…é…ç½®)
- **è¯´æ˜**: EBS I/O Credits ä½™é¢
- **å»ºè®®é˜ˆå€¼**: â‰¤ 50%
- **è§¦å‘åŸå› **: æœ¬æ¬¡äº‹ä»¶çš„ä¸»è¦å‘Šè­¦

#### ReadIOPS (æŒ‰å®ä¾‹ç±»å‹)
| å®ä¾‹ç±»å‹ | é˜ˆå€¼ | é€‚ç”¨å®ä¾‹ |
|---------|------|---------|
| m6g.large | â‰¥ 8000 IOPS | bingo-prd, replica1, backstage |
| t4g.medium | â‰¥ 4000 IOPS | backstage-replica1, loyalty |

#### ReadThroughput (æŒ‰å®ä¾‹ç±»å‹)
| å®ä¾‹ç±»å‹ | é˜ˆå€¼ | ç½‘ç»œå¸¦å®½å æ¯” | é€‚ç”¨å®ä¾‹ |
|---------|------|-------------|---------|
| m6g.large | â‰¥ 800 MB/s | 64% of 1,250 MB/s | bingo-prd, replica1, backstage |
| t4g.medium | â‰¥ 200 MB/s | 77% of 260 MB/s | backstage-replica1, loyalty |

**æ³¨**: t4g.medium åœ¨æœ¬æ¬¡äº‹ä»¶ä¸­è¾¾åˆ° 259 MB/s (99.6% ç½‘ç»œå®¹é‡)

#### ReadLatency
| å®ä¾‹ | é˜ˆå€¼ | è¯´æ˜ |
|------|------|------|
| bingo-prd | â‰¥ 0.01s | 10ms å»¶è¿Ÿå‘Šè­¦ |
| bingo-prd-backstage | â‰¥ 0.01s | 10ms å»¶è¿Ÿå‘Šè­¦ |
| bingo-prd-backstage-replica1 | â‰¥ 0.01s | 10ms å»¶è¿Ÿå‘Šè­¦ |

#### WriteLatency
| å®ä¾‹ | é˜ˆå€¼ | è¯´æ˜ |
|------|------|------|
| bingo-prd | â‰¥ 0.01s | 10ms å»¶è¿Ÿå‘Šè­¦ |
| bingo-prd-backstage | â‰¥ 0.01s | 10ms å»¶è¿Ÿå‘Šè­¦ |
| bingo-prd-loyalty | â‰¥ 0.01s | 10ms å»¶è¿Ÿå‘Šè­¦ |

#### DiskQueueDepth (æ‰€æœ‰å®ä¾‹)
- **é˜ˆå€¼**: â‰¥ 5
- **è¯´æ˜**: ç­‰å¾… I/O çš„è¯·æ±‚æ•°
- **é€‚ç”¨**: æ‰€æœ‰ 5 ä¸ªå®ä¾‹

---

### 4ï¸âƒ£ ç½‘ç»œååé‡

#### NetworkReceiveThroughput (æŒ‰å®ä¾‹ç±»å‹)
| å®ä¾‹ç±»å‹ | é˜ˆå€¼ | ç½‘ç»œå¸¦å®½å æ¯” | é€‚ç”¨å®ä¾‹ |
|---------|------|-------------|---------|
| m6g.large | â‰¥ 1000 MB/s | 80% of 1,250 MB/s | bingo-prd, replica1, backstage |
| t4g.medium | â‰¥ 250 MB/s | 96% of 260 MB/s | backstage-replica1, loyalty |

**å…³é”®**: t4g é˜ˆå€¼è®¾ç½®ä¸º 96% æ˜¯å› ä¸ºæœ¬æ¬¡äº‹ä»¶è¾¾åˆ° 99.6% å¯¼è‡´æ€§èƒ½é—®é¢˜

---

### 5ï¸âƒ£ æ•°æ®åº“è¿æ¥æ•°

#### DatabaseConnections (ä»… m6g.large)
| å®ä¾‹ | é˜ˆå€¼ | max_connections å æ¯” |
|------|------|---------------------|
| bingo-prd | â‰¥ 150 | 69% of ~216 |
| bingo-prd-replica1 | â‰¥ 150 | 69% of ~216 |
| bingo-prd-backstage | â‰¥ 150 | 69% of ~216 |

**æ³¨**: t4g.medium å®ä¾‹ä¸ç›‘æ§æ­¤æŒ‡æ ‡ (è¿æ¥æ•°è¾ƒä½)

---

### 6ï¸âƒ£ å­˜å‚¨ç©ºé—´

#### FreeStorageSpace (æŒ‰å®ä¾‹æ•°æ®é‡)
| å®ä¾‹ | é˜ˆå€¼ | è¯´æ˜ |
|------|------|------|
| bingo-prd | â‰¤ 200 GB | ä¸»æ•°æ®åº“ |
| bingo-prd-backstage | â‰¤ 300 GB | åå°æ•°æ®åº“ (æ•°æ®é‡è¾ƒå¤§) |
| bingo-prd-loyalty | â‰¤ 40 GB | å¿ è¯šåº¦æ•°æ®åº“ (æ•°æ®é‡è¾ƒå°) |

#### TransactionLogsDiskUsage (ä»…ä¸»åº“)
| å®ä¾‹ | é˜ˆå€¼ | è¯´æ˜ |
|------|------|------|
| bingo-prd | â‰¥ 10 GB | WAL æ—¥å¿—è¿‡å¤§ |
| bingo-prd-backstage | â‰¥ 10 GB | WAL æ—¥å¿—è¿‡å¤§ |
| bingo-prd-loyalty | â‰¥ 10 GB | WAL æ—¥å¿—è¿‡å¤§ |

**æ³¨**: åªè¯»å‰¯æœ¬ä¸ç›‘æ§æ­¤æŒ‡æ ‡

---

### 7ï¸âƒ£ å¤åˆ¶å»¶è¿Ÿ

#### ReplicaLag (å¾…é…ç½®)
- **è¯´æ˜**: ä¸»ä»åŒæ­¥å»¶è¿Ÿ
- **å»ºè®®é˜ˆå€¼**: â‰¥ 30 ç§’
- **é€‚ç”¨**: bingo-prd-replica1, bingo-prd-backstage-replica1

---

## ğŸ“ˆ Dashboard é…ç½®

### Dashboard åç§°
**Production-RDS-Dashboard**

### Widget æ•°é‡
**19 ä¸ª** (è¦†ç›–æ‰€æœ‰å…³é”®æŒ‡æ ‡)

### å‘Šè­¦çº¿é¢œè‰²è¯´æ˜
- ğŸ”´ **çº¢è‰²**: ä¸»è¦å‘Šè­¦é˜ˆå€¼ (è§¦å‘é€šçŸ¥)
- ğŸŸ  **æ©™è‰²**: æ¬¡è¦å‘Šè­¦ / ä¸åŒå®ä¾‹ç±»å‹é˜ˆå€¼
- ğŸ“ **ç°è‰²**: å‚è€ƒçº¿ (ä¸è§¦å‘å‘Šè­¦)

---

## ğŸ”” é€šçŸ¥é…ç½®

### SNS Topic
```
ARN: arn:aws:sns:ap-east-1:470013648166:Cloudwatch-Slack-Notification
```

### è®¢é˜…è€…
1. **Email**: lonely.h@jvd.tw
2. **Lambda â†’ Slack**: Cloudwatch-Slack-Notification

### å‘Šè­¦è¯„ä¼°æ¡ä»¶
- **å‘¨æœŸ**: 300 ç§’ (5 åˆ†é’Ÿ)
- **è¯„ä¼°æ¬¡æ•°**: 2 æ¬¡
- **è§¦å‘æ¡ä»¶**: è¿ç»­ 2 ä¸ªå‘¨æœŸè¶…æ ‡ (çº¦ 10 åˆ†é’Ÿ)

---

## ğŸ“ å®ä¾‹ç±»å‹å¯¹æ¯”

| è§„æ ¼ | db.m6g.large | db.t4g.medium |
|------|-------------|---------------|
| **vCPU** | 2 | 2 |
| **å†…å­˜** | 8 GB | 4 GB |
| **ç½‘ç»œå¸¦å®½** | ~1,250 MB/s | ~260 MB/s |
| **max_connections** | ~216 | ~112 |
| **æ€§èƒ½æ¨¡å¼** | ç¨³å®šæ€§èƒ½ | çªå‘æ€§èƒ½ (CPU Credits) |
| **å®ä¾‹æ•°é‡** | 3 ä¸ª | 2 ä¸ª |
| **å‘Šè­¦æ•°é‡** | 10/10/6 ä¸ª | 7/9 ä¸ª |

---

## âš ï¸ å…³é”®å»ºè®®

### é«˜ä¼˜å…ˆçº§
1. âœ… **å·²é…ç½®**: NetworkReceiveThroughput å‘Šè­¦ (æœ¬æ¬¡äº‹ä»¶å…³é”®æŒ‡æ ‡)
2. âœ… **å·²é…ç½®**: å®ä¾‹ç±»å‹ç‰¹å®šé˜ˆå€¼
3. âœ… **å·²é…ç½®**: Dashboard å®Œæ•´ç›‘æ§

### å¾…é…ç½®
1. â³ **CPUUtilization** å•ç‹¬å‘Šè­¦ (ç›®å‰æœªé…ç½®)
2. â³ **EBSByteBalance%** å‘Šè­¦ (æœ¬æ¬¡äº‹ä»¶ä¸»è¦å‘Šè­¦ï¼Œåº”è¡¥å……)
3. â³ **ReplicaLag** å‘Šè­¦ (ä¸»ä»å»¶è¿Ÿç›‘æ§)

### æ€§èƒ½ä¼˜åŒ–å»ºè®®
- ğŸ” è€ƒè™‘å°† `bingo-prd-backstage-replica1` ä» t4g.medium å‡çº§åˆ° m6g.large
- ğŸ” å¯ç”¨ Performance Insights ä¿ç•™æœŸå»¶é•¿ (åˆ†ææ…¢æŸ¥è¯¢)
- ğŸ” é…ç½® `pg_stat_statements` æ‰©å±•

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

1. **å®Œæ•´è®°å½•**: `scripts/rds/RDS_MONITORING_COMPLETE_RECORD.md`
2. **å¿«é€Ÿå‚è€ƒ**: `scripts/rds/RDS_ALARMS_QUICK_REFERENCE.md`
3. **æ•…éšœæ’æŸ¥**: `scripts/rds/RDS_TROUBLESHOOTING_GUIDE.md`
4. **è„šæœ¬è¯´æ˜**: `scripts/rds/README.md`

---

**æœ€åæ›´æ–°**: 2025-10-29

---

## ğŸ“ æ›´æ–°è®°å½•

### 2025-10-29: DatabaseConnections é˜ˆå€¼ä¿®æ­£

**é—®é¢˜**: ä¹‹å‰ä½¿ç”¨é”™è¯¯çš„ max_connections è®¡ç®—ï¼ˆ~216ï¼‰ï¼Œå¯¼è‡´é˜ˆå€¼è¿‡ä½ï¼ˆ150 = 16.6%ï¼‰

**ä¿®æ­£**: åŸºäºæ­£ç¡®çš„ max_connections è®¡ç®—æ›´æ–°é˜ˆå€¼

| å®ä¾‹ç±»å‹ | max_connections | æ—§é˜ˆå€¼ | æ–°é˜ˆå€¼ | å æ¯” |
|---------|----------------|--------|--------|------|
| db.m6g.large | ~901 | 150 | **675** | 75% |
| db.t4g.medium | ~451 | æ—  | **340** | 75% |

**è¯¦ç»†è®°å½•**: å‚è§ `DATABASE_CONNECTIONS_CORRECTION_2025-10-29.md`

**å‘Šè­¦æ€»æ•°**: 42 â†’ **44** (+2)

